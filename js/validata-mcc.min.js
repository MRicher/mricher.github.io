const ORCAVIA_APP_VERSION="1.0.2",ORCAVIA_VERSION_STRING="Version 1.0.2";document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("version-info");e&&(e.textContent="Version 1.0.2")});class RCMPDataEditor{constructor(){this.data={data:[]},this.themeMapping={"Culture and accountability":"Culture et reddition de comptes",Firearms:"Armes à feu","Gender-based violence and intimate partner violence":"La violence fondée sur le sexe et la violence exercée par les partenaires intimes",Governance:"Gouvernance","Information sharing":"Communication d'information","Managing crises":"Gestion de crises","Organizational standards":"Normes organisationnelles","Partnerships and engagement":"Partenariats et engagement","Resourcing and recruitment":"Ressources et recrutement",Training:"Formation"},this.reversedThemeMapping=Object.fromEntries(Object.entries(this.themeMapping).map(([e,t])=>[t,e])),this.waitForLanguageInitialization()}init(){document.getElementById("file-upload").addEventListener("change",e=>this.handleFileUpload(e)),document.getElementById("add-record-btn").addEventListener("click",()=>this.addNewRecord()),document.getElementById("download-btn").addEventListener("click",()=>this.downloadData()),document.getElementById("load-from-url-btn").addEventListener("click",()=>this.loadFromURL()),this.render()}showAlert(e,t="success"){const a=document.getElementById("alerts-container"),n=document.createElement("div");n.className=`alert alert-${t} alert-dismissible fade show`;const r=window.languageSwitcher&&"fr"===window.languageSwitcher.currentLang?"Fermer":"Close";let i;if("object"==typeof e&&e.en&&e.fr){const t="fr"===(window.languageSwitcher?window.languageSwitcher.currentLang:"en")?e.fr:e.en;i=`<span data-en="${e.en}" data-fr="${e.fr}">${t}</span>`}else i=e;n.innerHTML=`\n\t        ${i}\n\t        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="${r}"></button>\n\t    `,a.appendChild(n),window.languageSwitcher&&window.languageSwitcher.switchLanguage(window.languageSwitcher.currentLang),setTimeout(()=>{n.parentNode&&n.remove()},5e3)}showUpdateAlert(e,t,a="danger"){const n=document.getElementById(`update-alerts-${e}`);if(!n)return;n.innerHTML="";const r=document.createElement("div");r.className=`alert alert-${a} alert-dismissible fade show`;const i=window.languageSwitcher&&"fr"===window.languageSwitcher.currentLang?"Fermer":"Close";r.innerHTML=`\n\t\t\t${t}\n\t\t\t<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="${i}"></button>\n\t\t`,n.appendChild(r),setTimeout(()=>{r.parentNode&&r.remove()},5e3)}sanitizeText(e){if(!e||"string"!=typeof e)return e;let t=e;t=t.replace(/’/g,"'"),t=t.replace(/ »/g,"&#160;»"),t=t.replace(/« /g,"«&#160;"),t=t.replace(/<p><br><\/p>/g,""),t=t.replace(/  /g," &#160;");const a=t.includes("<p>")||t.includes("ql-");t=t.replace(/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,e=>{const n=e.toLowerCase(),r=t.substring(0,t.indexOf(e)),i=t.substring(t.indexOf(e)+e.length);return r.includes('<a href="mailto:')&&!r.includes("</a>")&&i.includes("</a>")||a&&r.includes("<a ")&&i.includes("</a>")?n:a?e:`<a href="mailto:${n}">${n}</a>`});return["RCMP","GRC","MCC","CACP","CISC","ATIP","CPM","ACCP","SCRC","AIPRP","ICIR","IIIC","CAD","RAO","CCG","MAB"].forEach(e=>{t=((e,t)=>e.replace(new RegExp(`(?<!<abbr[^>]*>)\\b${t}\\b(?!</abbr>)`,"g"),(e,t,a)=>{const n=a.substring(0,t),r=a.substring(t+e.length);return n.lastIndexOf("<abbr")>n.lastIndexOf("</abbr>")&&r.includes("</abbr>")?e:`<abbr>${e}</abbr>`}))(t,e)}),t}sanitizeRecord(e){const t={};for(const[a,n]of Object.entries(e))t[a]="string"==typeof n?this.sanitizeText(n):n;return t}sanitizeAllData(){return{...this.data,data:this.data.data.map(e=>this.sanitizeRecord(e))}}async restoreScrollPosition(e){return new Promise(t=>{let a=0;const n=()=>{a++;const r=document.documentElement.scrollHeight,i=window.innerHeight;e<=r-i||a>=10?(window.scrollTo({top:Math.min(e,r-i),behavior:"instant"}),t()):requestAnimationFrame(n)};requestAnimationFrame(n)})}async loadFromURL(){const e=document.getElementById("load-from-url-btn"),t=e.textContent,a=window.pageYOffset||document.documentElement.scrollTop;try{e.textContent="Loading...",e.disabled=!0;const t=await fetch("mcc.json");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=await t.json();if(!n.data||!Array.isArray(n.data)){const e=window.languageSwitcher&&"fr"===window.languageSwitcher.currentLang?"Structure JSON invalide depuis l'URL":"Invalid JSON structure from URL";throw new Error(e)}this.data=n,this.render(),await this.restoreScrollPosition(a),this.showAlert({en:`Successfully loaded ${n.data.length} records from website!`,fr:`${n.data.length} enregistrements chargés avec succès depuis le site web !`})}catch(e){const t=window.languageSwitcher&&"fr"===window.languageSwitcher.currentLang?"Erreur lors du chargement des données depuis le site web : "+e.message:"Error loading data from website: "+e.message;this.showAlert(t,"error")}finally{e.textContent=t,e.disabled=!1}}async handleFileUpload(e){const t=e.target.files[0];if(!t)return;const a=window.pageYOffset||document.documentElement.scrollTop,n=new FileReader;n.onload=async e=>{try{const t=JSON.parse(e.target.result);if(!t.data||!Array.isArray(t.data)){const e=window.languageSwitcher&&"fr"===window.languageSwitcher.currentLang?"Structure JSON invalide":"Invalid JSON structure";throw new Error(e)}this.data=t,this.render(),await this.restoreScrollPosition(a),this.showAlert({en:"JSON file loaded successfully!",fr:"Fichier JSON chargé avec succès !"})}catch(e){const t=window.languageSwitcher&&"fr"===window.languageSwitcher.currentLang?"Erreur lors du chargement du fichier JSON : "+e.message:"Error loading JSON file: "+e.message;this.showAlert(t,"error")}},n.readAsText(t)}addNewRecord(){const e={"last-updated":this.getCurrentDateFormatted(),"english-theme":"","french-theme":"","english-commitment":"","french-commitment":"","english-title":"","french-title":"","english-summary":"","french-summary":"","english-progress":"","french-progress":"","recommendations-1":"","recommendations-2":"","recommendations-3":"","update-1-date":"","english-update-1":"","french-update-1":"","update-2-date":"","english-update-2":"","french-update-2":"","update-3-date":"","english-update-3":"","french-update-3":"","update-4-date":"","english-update-4":"","french-update-4":"","update-5-date":"","english-update-5":"","french-update-5":"","update-6-date":"","english-update-6":"","french-update-6":""};this.data.data.push(e),this.render(),this.showAlert({en:"New record added successfully!",fr:"Nouvel enregistrement ajouté avec succès !"})}getCurrentDateFormatted(){const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}deleteRecord(e){const t=window.languageSwitcher&&"fr"===window.languageSwitcher.currentLang?"Êtes-vous sûr de vouloir supprimer cet enregistrement ?":"Are you sure you want to delete this record?";confirm(t)&&(this.data.data.splice(e,1),this.render(),this.showAlert({en:"Enregistrement supprimé avec succès !",fr:"Record deleted successfully!"}))}downloadData(){const e=this.sanitizeAllData(),t=JSON.stringify(e,null,2),a=new Blob([t],{type:"application/json"}),n=URL.createObjectURL(a),r=document.createElement("a");r.href=n,r.download=`rcmp-data-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n);const i=window.languageSwitcher&&"fr"===window.languageSwitcher.currentLang?"Données téléchargées avec succès avec formatage assaini !":"Data downloaded successfully with sanitized formatting!";this.showAlert(i)}updateRecord(e,t,a){if(this.data.data[e]){if((t.includes("date")||"last-updated"===t)&&a)if(/^\d{4}-\d{2}-\d{2}$/.test(a))this.data.data[e][t]=a;else{const n=new Date(a);if(isNaN(n.getTime()))this.data.data[e][t]=a;else{const a=n.getFullYear(),r=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0");this.data.data[e][t]=`${a}-${r}-${i}`}}else this.data.data[e][t]=a;if("english-theme"===t&&this.themeMapping[a]){this.data.data[e]["french-theme"]=this.themeMapping[a];const t=document.getElementById(`french-theme-${e}`);t&&(t.value=this.themeMapping[a])}else if("french-theme"===t&&this.reversedThemeMapping[a]){this.data.data[e]["english-theme"]=this.reversedThemeMapping[a];const t=document.getElementById(`english-theme-${e}`);t&&(t.value=this.reversedThemeMapping[a])}else if("english-progress"===t){const t={"To be actioned":"À mettre en œuvre","In progress":"En cours",Complete:"Terminé","Re-envisioned":"Reconsidérée"};if(t[a]){this.data.data[e]["french-progress"]=t[a];const n=document.getElementById(`french-progress-${e}`);n&&(n.value=t[a])}}else if("french-progress"===t){const t={"À mettre en œuvre":"To be actioned","En cours":"In progress","Terminé":"Complete","Reconsidérée":"Re-envisioned"};if(t[a]){this.data.data[e]["english-progress"]=t[a];const n=document.getElementById(`english-progress-${e}`);n&&(n.value=t[a])}}}}getStatusClass(e){return e&&(e.toLowerCase().includes("complete")||e.toLowerCase().includes("terminé"))?"status-complete":"status-pending"}getThemeOptions(e,t=!0){return(t?Object.keys(this.themeMapping):Object.values(this.themeMapping)).map(t=>`<option value="${t}" ${e===t?"selected":""}>${t}</option>`).join("")}formatAllDateInputs(){document.querySelectorAll('input[type="date"]').forEach(e=>{this.formatDateInput(e)})}initializeQuillEditors(){if("undefined"!=typeof Quill){if(!Quill.imports["formats/abbr"]){const e=Quill.import("blots/inline");class t extends e{static blotName="abbr";static tagName="abbr"}Quill.register(t)}if(!Quill.imports["formats/cite"]){const e=Quill.import("blots/inline");class t extends e{static blotName="italic";static tagName="cite"}Quill.register(t,!0)}document.querySelectorAll(".quill-editor").forEach(e=>{e.getAttribute("data-editor-id");const t=e.getAttribute("data-field"),a=parseInt(e.getAttribute("data-record-index"));if(e.querySelector(".ql-toolbar"))return;const n=new Quill(e,{theme:"snow",modules:{toolbar:[["bold","italic"],["link"]],clipboard:{matchVisual:!1}}}),r=this.data.data[a];if(r&&r[t]){const e=r[t]||"";e&&n.clipboard.dangerouslyPasteHTML(e)}n.on("text-change",()=>{let e=n.root.innerHTML;"<p><br></p>"===e&&(e=""),this.updateRecord(a,t,e)})})}}render(){const e=document.getElementById("records-container"),t=document.activeElement,a=t?t.id:null;if(0===this.data.data.length)return e.innerHTML='\n                <div class="no-records">\n                    <h3 data-en="No records found" data-fr="Aucun enregistrement trouvé">No records found</h3>\n                    <p data-en="Upload a JSON file or add a new record to get started." data-fr="Téléversez un fichier JSON ou ajoutez un nouvel enregistrement pour commencer.">Upload a JSON file or add a new record to get started.</p>\n                </div>\n            ',window.languageSwitcher&&window.languageSwitcher.switchLanguage(window.languageSwitcher.currentLang),void this.formatAllDateInputs();const n=document.createDocumentFragment(),r=document.createElement("div");for(r.innerHTML=this.data.data.map((e,t)=>`\n            <div class="record-card">\n                <div class="record-header">\n                    <div>\n                        <h2 class="h4 mb-1" data-en="Record ${t+1}${e["english-title"]?` - ${e["english-title"]}`:""}" data-fr="Enregistrement ${t+1}${e["french-title"]?` - ${e["french-title"]}`:""}">Record ${t+1}${e["english-title"]?` - ${e["english-title"]}`:""}</h2>\n                        <span class="status-badge ${this.getStatusClass(e["english-progress"])}" data-en="${e["english-progress"]||"Unknown status"}" data-fr="${e["french-progress"]||"Statut inconnu"}">\n                            ${e["english-progress"]||"Unknown status"}\n                        </span>\n                        <small class="text-muted d-block mt-1" data-en="Updated: ${e["last-updated"]||"Not set"}" data-fr="Mis à jour : ${e["last-updated"]||"Non défini"}">Updated: ${e["last-updated"]||"Not set"}</small>\n                    </div>\n                    <button class="btn btn-danger btn-sm" onclick="editor.deleteRecord(${t})" data-en="Delete" data-fr="Supprimer">Delete</button>\n                </div>\n                \n                <div class="record-body">\n                    <div class="mb-3">\n                        <label for="last-updated-${t}" class="form-label" data-en="Last updated" data-fr="Dernière mise à jour">Last updated</label>\n                        <input type="date" class="form-control" id="last-updated-${t}" value="${e["last-updated"]||""}"\n                               onchange="editor.updateRecord(${t}, 'last-updated', this.value)"\n                               pattern="\\d{4}-\\d{2}-\\d{2}" placeholder="YYYY-MM-DD"\n                               data-en-lang="en-CA" data-fr-lang="fr-CA">\n                    </div>\n\n                    <div class="form-row mb-3">\n                        <div>\n                            <label for="english-theme-${t}" class="form-label" data-en="English theme" data-fr="Thème anglais">English theme</label>\n                            <select class="form-select" id="english-theme-${t}" onchange="editor.updateRecord(${t}, 'english-theme', this.value)">\n                                <option value="">Select a theme...</option>\n                                ${this.getThemeOptions(e["english-theme"],!0)}\n                            </select>\n                        </div>\n                        <div>\n                            <label for="french-theme-${t}" class="form-label" data-en="French theme" data-fr="Thème français">French theme</label>\n                            <select class="form-select" id="french-theme-${t}" onchange="editor.updateRecord(${t}, 'french-theme', this.value)">\n                                <option value="">Sélectionner un thème...</option>\n                                ${this.getThemeOptions(e["french-theme"],!1)}\n                            </select>\n                        </div>\n                    </div>\n\n                    <div class="form-row mb-3">\n                        <div>\n                            <label for="english-title-${t}" class="form-label" data-en="English title" data-fr="Titre anglais">English title</label>\n                            <textarea class="form-control" id="english-title-${t}" rows="3" onchange="editor.updateRecord(${t}, 'english-title', this.value)">${e["english-title"]||""}</textarea>\n                        </div>\n                        <div>\n                            <label for="french-title-${t}" class="form-label" data-en="French title" data-fr="Titre français">French title</label>\n                            <textarea class="form-control" id="french-title-${t}" rows="3" onchange="editor.updateRecord(${t}, 'french-title', this.value)">${e["french-title"]||""}</textarea>\n                        </div>\n                    </div>\n\n\t\t\t\t\t<div class="form-row mb-3">\n                        <div>\n                            <label for="english-summary-${t}" class="form-label" data-en="English summary" data-fr="Résumé anglais">English summary</label>\n                            <div class="quill-editor" id="english-summary-${t}" data-editor-id="english-summary-${t}" data-field="english-summary" data-record-index="${t}"></div>\n                        </div>\n                        <div>\n                            <label for="french-summary-${t}" class="form-label" data-en="French summary" data-fr="Résumé français">French summary</label>\n                            <div class="quill-editor" id="french-summary-${t}" data-editor-id="french-summary-${t}" data-field="french-summary" data-record-index="${t}"></div>\n                        </div>\n                    </div>\n\n                    <div class="form-row mb-3">\n                        <div>\n                            <label for="english-progress-${t}" class="form-label" data-en="English progress" data-fr="Progrès anglais">English progress</label>\n                            <select class="form-select" id="english-progress-${t}" onchange="editor.updateRecord(${t}, 'english-progress', this.value)">\n                                <option value="To be actioned" ${"To be actioned"===e["english-progress"]?"selected":""}>To be actioned</option>\n                                <option value="In progress" ${"In progress"===e["english-progress"]?"selected":""}>In progress</option>\n                                <option value="Complete" ${"Complete"===e["english-progress"]?"selected":""}>Complete</option>\n                                <option value="Re-envisioned" ${"Re-envisioned"===e["english-progress"]?"selected":""}>Re-envisioned</option>\n                            </select>\n                        </div>\n                        <div>\n                            <label for="french-progress-${t}" class="form-label" data-en="French progress" data-fr="Progrès français">French progress</label>\n                            <select class="form-select" id="french-progress-${t}" onchange="editor.updateRecord(${t}, 'french-progress', this.value)">\n                                <option value="À mettre en œuvre" ${"À mettre en œuvre"===e["french-progress"]?"selected":""}>À mettre en œuvre</option>\n                                <option value="En cours" ${"En cours"===e["french-progress"]?"selected":""}>En cours</option>\n                                <option value="Terminé" ${"Terminé"===e["french-progress"]?"selected":""}>Terminé</option>\n                                <option value="Reconsidérée" ${"Reconsidérée"===e["french-progress"]?"selected":""}>Reconsidérée</option>\n                            </select>\n                        </div>\n                    </div>\n\n                    <div class="mb-3">\n                        <label for="recommendations-${t}" class="form-label" data-en="Recommendations" data-fr="Recommandations">Recommendations</label>\n                        <input type="text" class="form-control" id="recommendations-${t}" value="${e["recommendations-1"]||""}"\n                               onchange="editor.updateRecord(${t}, 'recommendations-1', this.value)">\n                    </div>\n\n                    <div class="update-section">\n                        <h3 class="h5" data-en="Progress updates" data-fr="Mises à jour du progrès">Progress updates</h3>\n                        ${[1,2,3,4,5,6].map(a=>e[`update-${a}-date`]||e[`english-update-${a}`]||e[`french-update-${a}`]?`\n                                <div class="update-item">\n                                    <div class="d-flex justify-content-between align-items-center mb-3">\n                                        <h4 class="h6 mb-0" data-en="Update ${a}" data-fr="Mise à jour ${a}">Update ${a}</h4>\n                                        <button class="btn btn-outline-danger btn-sm" onclick="editor.deleteUpdate(${t}, ${a})" data-en="Delete" data-fr="Supprimer">Delete</button>\n                                    </div>\n                                    \n                                    <div class="mb-3">\n                                        <label for="update-${a}-date-${t}" class="form-label" data-en="Date" data-fr="Date">Date</label>\n                                        <input type="date" class="form-control" id="update-${a}-date-${t}" value="${e[`update-${a}-date`]||""}"\n                                               onchange="editor.updateRecord(${t}, 'update-${a}-date', this.value)"\n                                               pattern="\\d{4}-\\d{2}-\\d{2}" placeholder="YYYY-MM-DD"\n                                               data-en-lang="en-CA" data-fr-lang="fr-CA">\n                                    </div>\n                                    \n\t\t\t\t\t\t\t\t\t<div class="form-row">\n                                        <div>\n                                            <label for="english-update-${a}-${t}" class="form-label" data-en="English update" data-fr="Mise à jour anglaise">English update</label>\n                                            <div class="quill-editor" id="english-update-${a}-${t}" data-editor-id="english-update-${a}-${t}" data-field="english-update-${a}" data-record-index="${t}"></div>\n                                        </div>\n                                        <div>\n                                            <label for="french-update-${a}-${t}" class="form-label" data-en="French update" data-fr="Mise à jour française">French update</label>\n                                            <div class="quill-editor" id="french-update-${a}-${t}" data-editor-id="french-update-${a}-${t}" data-field="french-update-${a}" data-record-index="${t}"></div>\n                                        </div>\n                                    </div>\n                                </div>\n                            `:"").join("")}\n                        \n                        <button class="btn btn-outline-secondary btn-sm" onclick="editor.addUpdate(${t})" data-en="Add update" data-fr="Ajouter une mise à jour">Add update</button>\n\t\t\t<div id="update-alerts-${t}" class="mt-2"></div>\n                    </div>\n                </div>\n            </div>\n        `).join("");r.firstChild;)n.appendChild(r.firstChild);e.innerHTML="",e.appendChild(n),this.formatAllDateInputs();const i=this.getCurrentDateFormatted();e.querySelectorAll('input[type="date"]:not([data-initialized])').forEach(e=>{if(!e.value&&e.id.includes("update-")&&e.id.includes("-date-")){const t=e.id.match(/update-(\d+)-date-(\d+)/);if(t){const a=t[1],n=t[2],r=this.data.data[n];r&&r[`update-${a}-date`]===i&&(e.value=i)}}e.setAttribute("data-initialized","true")}),a&&requestAnimationFrame(()=>{const e=document.getElementById(a);e&&"function"==typeof e.focus&&e.focus()}),window.languageSwitcher&&window.languageSwitcher.switchLanguage(window.languageSwitcher.currentLang),this.initializeQuillEditors()}addUpdate(e){const t=this.data.data[e];if(!t)return;const a=document.getElementById(`update-alerts-${e}`);a&&(a.innerHTML="");for(let a=1;a<=6;a++)if(!t[`update-${a}-date`]&&!t[`english-update-${a}`]&&!t[`french-update-${a}`]){const n=this.getCurrentDateFormatted();t[`update-${a}-date`]=n,t[`english-update-${a}`]="",t[`french-update-${a}`]="",this.render(),setTimeout(()=>{const t=document.getElementById(`update-${a}-date-${e}`);t&&(t.value=n)},0);const r=window.languageSwitcher&&"fr"===window.languageSwitcher.currentLang?`Mise à jour ${a} ajoutée à l'enregistrement ${e+1} !`:`Update ${a} added to record ${e+1}!`;return void this.showAlert(r)}const n=window.languageSwitcher&&"fr"===window.languageSwitcher.currentLang||"fr"===document.documentElement.lang||"fr-CA"===document.documentElement.getAttribute("lang")?"Nombre maximum de mises à jour (6) atteint pour cet enregistrement.":"Maximum number of updates (6) reached for this record.";this.showUpdateAlert(e,n,"danger")}deleteUpdate(e,t){const a=window.languageSwitcher&&"fr"===window.languageSwitcher.currentLang?`Êtes-vous sûr de vouloir supprimer la mise à jour ${t} ?`:`Are you sure you want to delete update ${t}?`;if(confirm(a)){const a=this.data.data[e];if(a){a[`update-${t}-date`]="",a[`english-update-${t}`]="",a[`french-update-${t}`]="",this.render();const n=window.languageSwitcher&&"fr"===window.languageSwitcher.currentLang?`Mise à jour ${t} supprimée de l'enregistrement ${e+1} !`:`Update ${t} deleted from record ${e+1}!`;this.showAlert(n)}}}updateCalendarLanguage(){const e=document.documentElement.lang||"en-CA";document.querySelectorAll('input[type="date"]').forEach(t=>{t.setAttribute("lang",e),this.formatDateInput(t)})}formatDateInput(e){e&&(e.setAttribute("pattern","\\d{4}-\\d{2}-\\d{2}"),e.setAttribute("placeholder","YYYY-MM-DD"),e.hasAttribute("data-formatted")||(e.addEventListener("change",e=>{this.ensureDateFormat(e.target)}),e.setAttribute("data-formatted","true")))}ensureDateFormat(e){if(e.value&&!/^\d{4}-\d{2}-\d{2}$/.test(e.value)){const t=new Date(e.value);if(!isNaN(t.getTime())){const a=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");e.value=`${a}-${n}-${r}`}}}waitForLanguageInitialization(){window.languageSwitcher?this.init():setTimeout(()=>this.waitForLanguageInitialization(),50)}}document.addEventListener("DOMContentLoaded",function(){window.editor=new RCMPDataEditor});