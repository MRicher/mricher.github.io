<!DOCTYPE html>
<html lang="en-CA">
<head>
	<meta charset="UTF-8">
	<meta content="width=device-width, initial-scale=1.0" name="viewport">
	<title data-en="Monitora" data-fr="Monitora">Monitora</title>
	<meta content="" data-en="" data-fr="" name="description">
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/creavia.css" rel="stylesheet">
    <link href="css/quill.snow.css" rel="stylesheet">
</head>
<body>
	<a class="skip-link" data-en="Skip to main content" data-fr="Passer au contenu principal" href="#main-content">Skip to main content</a>
	<header>
		<nav aria-label="Main navigation" class="navbar navbar-expand-lg">
			<div class="container">
				<div class="navbar-brand d-flex align-items-center">
					<img alt="" class="me-2" src="img/tree.svg" style="height: 50px; width: auto;"> <span data-en="Monitora" data-fr="Monitora">Monitora</span>
				</div><button aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation menu" class="navbar-toggler" data-bs-target="#navbarNav" data-bs-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span> <span class="sr-only" data-en="Toggle navigation menu" data-fr="Basculer le menu de navigation">Toggle navigation menu</span></button>
				<div class="collapse navbar-collapse" id="navbarNav">
					<ul class="navbar-nav me-auto mb-2 mb-lg-0" role="menubar">
						<li class="nav-item" role="none">
							<a class="nav-link active" data-en="Home" data-fr="Accueil" href="index.html" role="menuitem">Home</a>
						</li>
					</ul>
					<div aria-label="Settings" class="language-switcher" role="group">
						<button aria-label="Toggle dark/light theme" class="theme-toggle" data-en-dark="Switch to Light mode" data-en-light="Switch to Dark mode" data-fr-dark="Passer au mode clair" data-fr-light="Passer au mode sombre" id="theme-toggle" type="button"><span data-en="Dark mode" data-fr="Mode sombre" id="theme-text">Dark mode</span></button> <button aria-label="Passer au français" aria-pressed="false" class="btn btn-outline-primary btn-sm" data-lang="fr-CA" id="lang-fr-btn" style="display: none;" type="button"><span data-en="Français" data-fr="Français">Français</span></button> <button aria-label="Switch to English" aria-pressed="false" class="btn btn-outline-primary btn-sm" data-lang="en-CA" id="lang-en-btn" type="button"><span data-en="English" data-fr="English">English</span></button>
					</div>
				</div>
			</div>
		</nav>
	</header>
	
	<main class="container" id="main-content">
		<button aria-label="Return to top of page" class="back-to-top" data-en="Return to top of page" data-fr="Retourner en haut de la page" id="backToTop" title="Return to top" type="button"></button>
		<section aria-labelledby="main-heading">
			<h1 data-en="Application Status Update" data-fr="Mise à jour du statut des applications">Application Status Update</h1>
			
			<p class="lead" data-en="Update operational status messages for applications and export to bilingual SHTM files." data-fr="Mettez à jour les messages d'état opérationnel des applications et exportez vers des fichiers SHTM bilingues.">Update operational status messages for applications and export to bilingual SHTM files.</p>
		</section>
		
		<!-- Main Form -->
		<form id="statusForm" novalidate>
			<div id="statusEntriesContainer">
				<!-- Status Entry 1 (Template) -->
				<div class="status-entry" data-entry-id="1">
					<h2 class="h4">
						<span data-en="Status Entry" data-fr="Entrée de statut">Status Entry</span> #<span class="entry-number">1</span>
					</h2>
					
					<!-- Application Selection -->
					<div class="form-group">
						<label class="bilingual-label" for="application-1">
							<span data-en="Application" data-fr="Application">Application</span>
							<span class="text-danger" aria-label="required">*</span>
						</label>
						<select class="form-control application-select" id="application-1" name="application-1" required aria-required="true" aria-describedby="application-help-1">
							<option value="" data-en="-- Select an application --" data-fr="-- Sélectionnez une application --">-- Select an application --</option>
							<option value="outlook">Microsoft Outlook</option>
							<option value="m365">Microsoft 365 (M365)</option>
						</select>
						<small id="application-help-1" class="form-text text-muted" data-en="Choose the application to update." data-fr="Choisissez l'application à mettre à jour.">Choose the application to update.</small>
					</div>
					
					<!-- Current Status -->
					<div class="form-group">
						<label class="bilingual-label" for="status-1">
							<span data-en="Current Status" data-fr="Statut actuel">Current Status</span>
							<span class="text-danger" aria-label="required">*</span>
						</label>
						<select class="form-control status-select" id="status-1" name="status-1" required aria-required="true" aria-describedby="status-help-1">
							<option value="" data-en="-- Select status --" data-fr="-- Sélectionnez le statut --">-- Select status --</option>
							<option value="no-issues" data-en="No reported issues" data-fr="Aucun problème signalé">No reported issues</option>
							<option value="incident" data-en="Incident" data-fr="Incident">Incident</option>
							<option value="outage" data-en="Outage" data-fr="Panne">Outage</option>
						</select>
						<small id="status-help-1" class="form-text text-muted" data-en="Select the current operational status." data-fr="Sélectionnez le statut opérationnel actuel.">Select the current operational status.</small>
					</div>
					
					<!-- Pre-determined Messages -->
					<div class="form-group">
						<label class="bilingual-label" for="message-1">
							<span data-en="Status Message" data-fr="Message de statut">Status Message</span>
							<span class="text-danger" aria-label="required">*</span>
						</label>
						<select class="form-control message-select" id="message-1" name="message-1" required aria-required="true" aria-describedby="message-help-1">
							<option value="" data-en="-- Select a message --" data-fr="-- Sélectionnez un message --">-- Select a message --</option>
							<option value="other" data-en="Other" data-fr="Autre">Other</option>
						</select>
						<small id="message-help-1" class="form-text text-muted" data-en="Choose a pre-defined message or select 'Other' to write your own." data-fr="Choisissez un message prédéfini ou sélectionnez « Autre » pour écrire le vôtre.">Choose a pre-defined message or select "Other" to write your own.</small>
					</div>
					
					<!-- Custom Message Section (Hidden by default) -->
					<div class="custom-message-section" id="custom-message-1" role="region" aria-labelledby="custom-message-heading-1">
						<h3 class="h5" id="custom-message-heading-1" data-en="Custom Message" data-fr="Message personnalisé">Custom Message</h3>
						
						<div class="form-group">
							<label class="bilingual-label" for="custom-en-1" data-en="English Message" data-fr="Message en anglais">English Message</label>
							<textarea class="form-control custom-message-en" id="custom-en-1" name="custom-en-1" rows="4" aria-describedby="custom-en-help-1"></textarea>
							<small id="custom-en-help-1" class="form-text text-muted" data-en="Enter your custom message in English." data-fr="Entrez votre message personnalisé en anglais.">Enter your custom message in English.</small>
						</div>
						
						<div class="form-group">
							<label class="bilingual-label" for="custom-fr-1" data-en="French Message" data-fr="Message en français">French Message</label>
							<textarea class="form-control custom-message-fr" id="custom-fr-1" name="custom-fr-1" rows="4" aria-describedby="custom-fr-help-1"></textarea>
							<small id="custom-fr-help-1" class="form-text text-muted" data-en="Enter your custom message in French." data-fr="Entrez votre message personnalisé en français.">Enter your custom message in French.</small>
						</div>
					</div>
				</div>
			</div>
			
			<!-- Action Buttons -->
			<div class="action-buttons" role="group" aria-label="Form actions">
				<button type="button" class="btn btn-secondary" id="addEntryBtn" data-en="+ Add Another Status Entry" data-fr="+ Ajouter une autre entrée de statut">+ Add Another Status Entry</button>
				
				<button type="submit" class="btn btn-success" data-en="Generate SHTM File" data-fr="Générer le fichier SHTM">Generate SHTM File</button>
				
				<button type="reset" class="btn btn-outline-secondary" data-en="Reset Form" data-fr="Réinitialiser le formulaire">Reset Form</button>
			</div>
		</form>
		
		<!-- Success/Error Messages -->
		<div id="alertContainer" class="mt-3" role="alert" aria-live="polite" aria-atomic="true"></div>
	</main>
	
	<footer class="mt-auto">
		<div class="container">
			<div class="text-center">
				<p class="mb-0" data-en="Monitora - Application Status Manager v1.0" data-fr="Monitora - Gestionnaire de statut des applications v1.0" id="version-info">Monitora - Application Status Manager v1.0</p>
			</div>
		</div>
	</footer>
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.slim.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.3/js/bootstrap.bundle.min.js"></script>
	
	<script>
		// Pre-determined messages for each application
		const messageTemplates = {
			outlook: {
				'no-issues': [
					{ value: 'msg1', en: 'All Outlook services are operating normally.', fr: 'Tous les services Outlook fonctionnent normalement.' },
					{ value: 'msg2', en: 'No current issues affecting Outlook.', fr: 'Aucun problème actuel n\'affecte Outlook.' }
				],
				'incident': [
					{ value: 'msg3', en: 'We are investigating reports of Outlook connectivity issues.', fr: 'Nous enquêtons sur des rapports de problèmes de connectivité Outlook.' },
					{ value: 'msg4', en: 'Some users may experience delayed email delivery.', fr: 'Certains utilisateurs peuvent rencontrer des retards de livraison de courriels.' }
				],
				'outage': [
					{ value: 'msg5', en: 'Outlook services are currently unavailable. We are working to restore access.', fr: 'Les services Outlook sont actuellement indisponibles. Nous travaillons à rétablir l\'accès.' },
					{ value: 'msg6', en: 'Major outage affecting all Outlook users. Estimated restoration time: 2 hours.', fr: 'Panne majeure affectant tous les utilisateurs Outlook. Temps de rétablissement estimé : 2 heures.' }
				]
			},
			m365: {
				'no-issues': [
					{ value: 'msg7', en: 'All Microsoft 365 services are running smoothly.', fr: 'Tous les services Microsoft 365 fonctionnent correctement.' },
					{ value: 'msg8', en: 'No disruptions to M365 services at this time.', fr: 'Aucune interruption des services M365 pour le moment.' }
				],
				'incident': [
					{ value: 'msg9', en: 'We are aware of performance issues affecting some M365 applications.', fr: 'Nous sommes conscients de problèmes de performance affectant certaines applications M365.' },
					{ value: 'msg10', en: 'Teams and SharePoint may be experiencing intermittent connectivity.', fr: 'Teams et SharePoint peuvent rencontrer une connectivité intermittente.' }
				],
				'outage': [
					{ value: 'msg11', en: 'Microsoft 365 services are experiencing a complete outage. Updates to follow.', fr: 'Les services Microsoft 365 subissent une panne complète. Mises à jour à suivre.' },
					{ value: 'msg12', en: 'Critical outage impacting all M365 services. Our team is working on resolution.', fr: 'Panne critique affectant tous les services M365. Notre équipe travaille à la résolution.' }
				]
			}
		};
		
		let entryCounter = 1;
		
		// Initialize form
		document.addEventListener('DOMContentLoaded', function() {
			// Initialize language system
			initializeLanguage();
			setupEventListeners();
			updateMessageOptions(1); // Initialize first entry
		});
		
		// Initialize language switching
		function initializeLanguage() {
			const currentLang = localStorage.getItem('language') || 'en-CA';
			setLanguage(currentLang);
			
			// Language button listeners
			document.getElementById('lang-en-btn').addEventListener('click', function() {
				setLanguage('en-CA');
			});
			
			document.getElementById('lang-fr-btn').addEventListener('click', function() {
				setLanguage('fr-CA');
			});
		}
		
		// Set language and update all text
		function setLanguage(lang) {
			localStorage.setItem('language', lang);
			const isEnglish = lang === 'en-CA';
			const isFrench = lang === 'fr-CA';
			
			// Update document language
			document.documentElement.lang = lang;
			
			// Show/hide language buttons
			document.getElementById('lang-en-btn').style.display = isFrench ? 'inline-block' : 'none';
			document.getElementById('lang-fr-btn').style.display = isEnglish ? 'inline-block' : 'none';
			
			document.getElementById('lang-en-btn').setAttribute('aria-pressed', isEnglish);
			document.getElementById('lang-fr-btn').setAttribute('aria-pressed', isFrench);
			
			// Update all elements with data-en and data-fr attributes
			document.querySelectorAll('[data-en][data-fr]').forEach(element => {
				const text = isEnglish ? element.getAttribute('data-en') : element.getAttribute('data-fr');
				if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
					element.placeholder = text;
				} else if (element.tagName === 'OPTION') {
					element.textContent = text;
				} else {
					// Handle HTML content in attributes (like <abbr> tags)
					element.innerHTML = text;
				}
			});
		}
		
		// Setup all event listeners
		function setupEventListeners() {
			// Application change listener
			document.addEventListener('change', function(e) {
				if (e.target.classList.contains('application-select') || e.target.classList.contains('status-select')) {
					const entryId = e.target.id.split('-')[1];
					updateMessageOptions(entryId);
				}
				
				if (e.target.classList.contains('message-select')) {
					const entryId = e.target.id.split('-')[1];
					toggleCustomMessage(entryId, e.target.value);
				}
			});
			
			// Add entry button
			document.getElementById('addEntryBtn').addEventListener('click', addStatusEntry);
			
			// Form submission
			document.getElementById('statusForm').addEventListener('submit', handleFormSubmit);
			
			// Form reset
			document.getElementById('statusForm').addEventListener('reset', function() {
				setTimeout(() => {
					document.querySelectorAll('.custom-message-section').forEach(section => {
						section.classList.remove('show');
					});
				}, 10);
			});
		}
		
		// Update message dropdown based on application and status selection
		function updateMessageOptions(entryId) {
			const appSelect = document.getElementById(`application-${entryId}`);
			const statusSelect = document.getElementById(`status-${entryId}`);
			const messageSelect = document.getElementById(`message-${entryId}`);
			
			const app = appSelect.value;
			const status = statusSelect.value;
			
			// Clear existing options except first and "Other"
			messageSelect.innerHTML = `
				<option value="">-- Select a message -- / -- Sélectionnez un message --</option>
			`;
			
			// Add messages if both app and status are selected
			if (app && status && messageTemplates[app] && messageTemplates[app][status]) {
				messageTemplates[app][status].forEach(msg => {
					const option = document.createElement('option');
					option.value = msg.value;
					option.dataset.en = msg.en;
					option.dataset.fr = msg.fr;
					
					// Set text based on current language
					const currentLang = localStorage.getItem('language') || 'en-CA';
					option.textContent = currentLang === 'en-CA' ? msg.en : msg.fr;
					
					messageSelect.appendChild(option);
				});
			}
			
			// Always add "Other" option at the end
			const otherOption = document.createElement('option');
			otherOption.value = 'other';
			otherOption.dataset.en = 'Other';
			otherOption.dataset.fr = 'Autre';
			
			// Set text based on current language
			const currentLang = localStorage.getItem('language') || 'en-CA';
			otherOption.textContent = currentLang === 'en-CA' ? 'Other' : 'Autre';
			messageSelect.appendChild(otherOption);
			
			// Reset message selection
			messageSelect.value = '';
			toggleCustomMessage(entryId, '');
		}
		
		// Toggle custom message section
		function toggleCustomMessage(entryId, value) {
			const customSection = document.getElementById(`custom-message-${entryId}`);
			const customEnTextarea = document.getElementById(`custom-en-${entryId}`);
			const customFrTextarea = document.getElementById(`custom-fr-${entryId}`);
			
			if (value === 'other') {
				customSection.classList.add('show');
				customEnTextarea.required = true;
				customFrTextarea.required = true;
				customEnTextarea.setAttribute('aria-required', 'true');
				customFrTextarea.setAttribute('aria-required', 'true');
			} else {
				customSection.classList.remove('show');
				customEnTextarea.required = false;
				customFrTextarea.required = false;
				customEnTextarea.removeAttribute('aria-required');
				customFrTextarea.removeAttribute('aria-required');
				customEnTextarea.value = '';
				customFrTextarea.value = '';
			}
		}
		
		// Add a new status entry
		function addStatusEntry() {
			entryCounter++;
			const container = document.getElementById('statusEntriesContainer');
			
			const newEntry = document.createElement('div');
			newEntry.className = 'status-entry';
			newEntry.dataset.entryId = entryCounter;
			newEntry.innerHTML = `
				<h2 class="h4">
					<span data-en="Status Entry" data-fr="Entrée de statut">Status Entry</span> #<span class="entry-number">${entryCounter}</span>
				</h2>
				
				<div class="form-group">
					<label class="bilingual-label" for="application-${entryCounter}">
						<span data-en="Application" data-fr="Application">Application</span>
						<span class="text-danger" aria-label="required">*</span>
					</label>
					<select class="form-control application-select" id="application-${entryCounter}" name="application-${entryCounter}" required aria-required="true" aria-describedby="application-help-${entryCounter}">
						<option value="" data-en="-- Select an application --" data-fr="-- Sélectionnez une application --">-- Select an application --</option>
						<option value="outlook">Microsoft Outlook</option>
						<option value="m365">Microsoft 365 (M365)</option>
					</select>
					<small id="application-help-${entryCounter}" class="form-text text-muted" data-en="Choose the application to update." data-fr="Choisissez l'application à mettre à jour.">Choose the application to update.</small>
				</div>
				
				<div class="form-group">
					<label class="bilingual-label" for="status-${entryCounter}">
						<span data-en="Current Status" data-fr="Statut actuel">Current Status</span>
						<span class="text-danger" aria-label="required">*</span>
					</label>
					<select class="form-control status-select" id="status-${entryCounter}" name="status-${entryCounter}" required aria-required="true" aria-describedby="status-help-${entryCounter}">
						<option value="" data-en="-- Select status --" data-fr="-- Sélectionnez le statut --">-- Select status --</option>
						<option value="no-issues" data-en="No reported issues" data-fr="Aucun problème signalé">No reported issues</option>
						<option value="incident" data-en="Incident" data-fr="Incident">Incident</option>
						<option value="outage" data-en="Outage" data-fr="Panne">Outage</option>
					</select>
					<small id="status-help-${entryCounter}" class="form-text text-muted" data-en="Select the current operational status." data-fr="Sélectionnez le statut opérationnel actuel.">Select the current operational status.</small>
				</div>
				
				<div class="form-group">
					<label class="bilingual-label" for="message-${entryCounter}">
						<span data-en="Status Message" data-fr="Message de statut">Status Message</span>
						<span class="text-danger" aria-label="required">*</span>
					</label>
					<select class="form-control message-select" id="message-${entryCounter}" name="message-${entryCounter}" required aria-required="true" aria-describedby="message-help-${entryCounter}">
						<option value="" data-en="-- Select a message --" data-fr="-- Sélectionnez un message --">-- Select a message --</option>
						<option value="other" data-en="Other" data-fr="Autre">Other</option>
					</select>
					<small id="message-help-${entryCounter}" class="form-text text-muted" data-en="Choose a pre-defined message or select 'Other' to write your own." data-fr="Choisissez un message prédéfini ou sélectionnez « Autre » pour écrire le vôtre.">Choose a pre-defined message or select "Other" to write your own.</small>
				</div>
				
				<div class="custom-message-section" id="custom-message-${entryCounter}" role="region" aria-labelledby="custom-message-heading-${entryCounter}">
					<h3 class="h5" id="custom-message-heading-${entryCounter}" data-en="Custom Message" data-fr="Message personnalisé">Custom Message</h3>
					
					<div class="form-group">
						<label class="bilingual-label" for="custom-en-${entryCounter}" data-en="English Message" data-fr="Message en anglais">English Message</label>
						<textarea class="form-control custom-message-en" id="custom-en-${entryCounter}" name="custom-en-${entryCounter}" rows="4" aria-describedby="custom-en-help-${entryCounter}"></textarea>
						<small id="custom-en-help-${entryCounter}" class="form-text text-muted" data-en="Enter your custom message in English." data-fr="Entrez votre message personnalisé en anglais.">Enter your custom message in English.</small>
					</div>
					
					<div class="form-group">
						<label class="bilingual-label" for="custom-fr-${entryCounter}" data-en="French Message" data-fr="Message en français">French Message</label>
						<textarea class="form-control custom-message-fr" id="custom-fr-${entryCounter}" name="custom-fr-${entryCounter}" rows="4" aria-describedby="custom-fr-help-${entryCounter}"></textarea>
						<small id="custom-fr-help-${entryCounter}" class="form-text text-muted" data-en="Enter your custom message in French." data-fr="Entrez votre message personnalisé en français.">Enter your custom message in French.</small>
					</div>
				</div>
				
				<button type="button" class="btn btn-danger btn-sm remove-entry-btn" data-entry-id="${entryCounter}" data-en="Remove This Entry" data-fr="Supprimer cette entrée">Remove This Entry</button>
			`;
			
			container.appendChild(newEntry);
			
			// Add remove button listener
			newEntry.querySelector('.remove-entry-btn').addEventListener('click', function() {
				newEntry.remove();
				showAlert(getLocalizedText('Entry removed successfully.', 'Entrée supprimée avec succès.'), 'info');
			});
			
			// Initialize message options for new entry
			updateMessageOptions(entryCounter);
			
			// Update language for new entry elements
			const currentLang = localStorage.getItem('language') || 'en-CA';
			updateElementLanguage(newEntry, currentLang);
			
			// Focus on new entry
			newEntry.querySelector('.application-select').focus();
			
			showAlert(getLocalizedText('New status entry added.', 'Nouvelle entrée de statut ajoutée.'), 'success');
		}
		
		// Helper function to update language for specific element
		function updateElementLanguage(element, lang) {
			const isEnglish = lang === 'en-CA';
			element.querySelectorAll('[data-en][data-fr]').forEach(el => {
				const text = isEnglish ? el.getAttribute('data-en') : el.getAttribute('data-fr');
				if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
					el.placeholder = text;
				} else if (el.tagName === 'OPTION') {
					el.textContent = text;
				} else {
					el.innerHTML = text;
				}
			});
		}
		
		// Helper function to get localized text
		function getLocalizedText(enText, frText) {
			const currentLang = localStorage.getItem('language') || 'en-CA';
			return currentLang === 'en-CA' ? enText : frText;
		}
		
		// Handle form submission
		function handleFormSubmit(e) {
			e.preventDefault();
			
			// Validate form
			if (!validateForm()) {
				showAlert(getLocalizedText('Please fill in all required fields.', 'Veuillez remplir tous les champs obligatoires.'), 'danger');
				return;
			}
			
			// Collect form data
			const formData = collectFormData();
			
			if (formData.length === 0) {
				showAlert(getLocalizedText('No valid entries to export.', 'Aucune entrée valide à exporter.'), 'warning');
				return;
			}
			
			// Generate and download SHTM file for each entry
			formData.forEach(entry => {
				generateSHTMFile(entry);
			});
			
			showAlert(getLocalizedText(`Successfully generated ${formData.length} SHTM file(s).`, `${formData.length} fichier(s) SHTM généré(s) avec succès.`), 'success');
		}
		
		// Validate form
		function validateForm() {
			const form = document.getElementById('statusForm');
			let isValid = true;
			
			// Check HTML5 validation
			if (!form.checkValidity()) {
				form.classList.add('was-validated');
				return false;
			}
			
			// Additional custom validation
			document.querySelectorAll('.status-entry').forEach(entry => {
				const entryId = entry.dataset.entryId;
				const messageSelect = document.getElementById(`message-${entryId}`);
				
				if (messageSelect && messageSelect.value === 'other') {
					const customEn = document.getElementById(`custom-en-${entryId}`);
					const customFr = document.getElementById(`custom-fr-${entryId}`);
					
					if (!customEn.value.trim() || !customFr.value.trim()) {
						isValid = false;
						customEn.classList.add('is-invalid');
						customFr.classList.add('is-invalid');
					}
				}
			});
			
			return isValid;
		}
		
		// Collect form data
		function collectFormData() {
			const entries = [];
			
			document.querySelectorAll('.status-entry').forEach(entry => {
				const entryId = entry.dataset.entryId;
				const app = document.getElementById(`application-${entryId}`).value;
				const status = document.getElementById(`status-${entryId}`).value;
				const messageSelect = document.getElementById(`message-${entryId}`);
				const messageValue = messageSelect.value;
				
				if (!app || !status || !messageValue) {
					return; // Skip incomplete entries
				}
				
				let messageEn, messageFr;
				
				if (messageValue === 'other') {
					messageEn = document.getElementById(`custom-en-${entryId}`).value.trim();
					messageFr = document.getElementById(`custom-fr-${entryId}`).value.trim();
				} else {
					const selectedOption = messageSelect.options[messageSelect.selectedIndex];
					messageEn = selectedOption.dataset.en;
					messageFr = selectedOption.dataset.fr;
				}
				
				entries.push({
					application: app,
					status: status,
					messageEn: messageEn,
					messageFr: messageFr
				});
			});
			
			return entries;
		}
		
		// Generate SHTM file
		function generateSHTMFile(entry) {
			const timestamp = new Date().toISOString();
			const filename = entry.application === 'outlook' ? 'outlook.shtm' : 'm365.shtm';
			
			// Create bilingual SHTM content
			const shtmlContent = `<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Status Update - ${entry.application}</title>
</head>
<body>
	<div class="status-update" data-app="${entry.application}" data-status="${entry.status}" data-timestamp="${timestamp}">
		<div lang="en" class="message-en">
			<h2>English</h2>
			<p>${escapeHtml(entry.messageEn)}</p>
		</div>
		<div lang="fr" class="message-fr">
			<h2>Français</h2>
			<p>${escapeHtml(entry.messageFr)}</p>
		</div>
	</div>
</body>
</html>`;
			
			// Create and download file
			const blob = new Blob([shtmlContent], { type: 'text/html' });
			const url = window.URL.createObjectURL(blob);
			const a = document.createElement('a');
			a.href = url;
			a.download = filename;
			document.body.appendChild(a);
			a.click();
			
			// Cleanup
			window.URL.revokeObjectURL(url);
			document.body.removeChild(a);
		}
	</main>
	<footer class="mt-auto">
		<div class="container">
			<div class="text-center">
				<p class="mb-0" data-en="" data-fr="" id="version-info"></p>
			</div>
		</div>
	</footer>
	<script src="js/bootstrap.bundle.min.js">
	</script> 
	<script src="js/creavia.js">
	</script>
    <script src="js/quill.js">
    </script>
</body>
</html>
